### This file was generated by Nexus Schema
### Do not make changes to this file directly


type Card {
  answers: [String!]!
  deckId: ID!
  editedAt: DateTime!
  fullAnswer: JSONObject!
  id: ID!
  mainTemplate: Boolean!
  ownRecord: UserCardRecord
  prompt: JSONObject!
  template: Boolean!
}

input CardCreateInput {
  answers: [String!]!
  fullAnswer: JSONObject!
  prompt: JSONObject!
  template: Boolean
}

"""
A date-time string at UTC, such as 2007-12-03T10:15:30Z, compliant with the `date-time` format outlined in section 5.6 of the RFC 3339 profile of the ISO 8601 standard for representation of dates and times using the Gregorian calendar.
"""
scalar DateTime

type Deck {
  answerLang: String!

  """
  all cards directly belonging to some descendant (reflexive, transitive closure of subdeck) deck of this deck
  """
  cardsAllUnder: [Card!]!

  """all cards directly belonging to this deck"""
  cardsDirect: [Card!]!

  """number of all cards directly belonging to this deck"""
  cardsDirectCount: Int!
  createdAt: DateTime!

  """
  all descendant (reflexive, transitive closure of subdeck) decks of this deck
  """
  descendantDecks: [Deck!]!
  description: JSONObject!
  editedAt: DateTime!
  id: ID!
  name: String!
  ownRecord: UserDeckRecord
  owner: User!
  ownerId: ID!
  promptLang: String!
  published: Boolean!
  sortData: [String!]!

  """all direct subdecks of this deck"""
  subdecks: [Deck!]!

  """count of all direct subdecks of this deck"""
  subdecksCount: Int!
  usedAt: DateTime!
}

enum DecksQueryScope {
  OWNED
  PARTICIPATED
  VISIBLE
}

"""
A field whose value conforms to the standard internet email address format as specified in RFC822: https://www.w3.org/Protocols/rfc822/.
"""
scalar EmailAddress @specifiedBy(url: "https://www.w3.org/Protocols/rfc822/")

"""
The `JSON` scalar type represents JSON values as specified by [ECMA-404](http://www.ecma-international.org/publications/files/ECMA-ST/ECMA-404.pdf).
"""
scalar JSON @specifiedBy(url: "http://www.ecma-international.org/publications/files/ECMA-ST/ECMA-404.pdf")

"""
The `JSONObject` scalar type represents JSON objects as specified by [ECMA-404](http://www.ecma-international.org/publications/files/ECMA-ST/ECMA-404.pdf).
"""
scalar JSONObject @specifiedBy(url: "http://www.ecma-international.org/publications/files/ECMA-ST/ECMA-404.pdf")

"""
A field whose value is a JSON Web Token (JWT): https://jwt.io/introduction.
"""
scalar JWT

type Message {
  content: JSON!
  createdAt: DateTime!
  id: ID!
  room: Room!
  roomId: ID!
  sender: User
  senderId: ID
  type: MessageContentType!
}

enum MessageContentType {
  CONFIG
  CONTEST_SCORE
  ROUND_SCORE
  ROUND_START
  ROUND_WIN
  TEXT
}

type MessageUpdate {
  operation: MessageUpdateOperation!
  value: Message!
}

enum MessageUpdateOperation {
  messageCreate
}

type Mutation {
  cardCreate(card: CardCreateInput!, deckId: ID!, mainTemplate: Boolean): Card!
  cardDelete(id: ID!): Card!
  cardEdit(answers: [String!], fullAnswer: JSONObject, id: ID!, mainTemplate: Boolean, prompt: JSONObject, template: Boolean): Card!
  cardUnsetMainTemplate(deckId: ID!): Card
  deckAddCards(cards: [CardCreateInput!]!, deckId: ID!): Deck!
  deckAddSubdeck(id: ID!, subdeckId: ID!): Deck!
  deckCreate(answerLang: String, cards: [CardCreateInput!], description: JSONObject, name: String, promptLang: String, published: Boolean): Deck!
  deckDelete(id: ID!): Deck!
  deckEdit(answerLang: String, description: JSONObject, id: ID!, name: String, promptLang: String, published: Boolean): Deck!
  deckRemoveSubdeck(id: ID!, subdeckId: ID!): Deck!
  deckUsed(id: ID!): Deck!
  finalizeOauthSignin(code: String!, nonce: String!, provider: String!, redirect_uri: String!): SessionInfo
  initializeOauthSignin: String!

  """
  @triggersSubscriptions(
      signatures: ["messagesOfRoomUpdates"]
    )
  """
  messageCreate(content: JSON, slug: String!, type: MessageContentType!): Message!
  ownCardRecordSet(cardId: ID!, correctRecordAppend: [DateTime!]!): UserCardRecord
  ownDeckRecordSet(deckId: ID!, notes: JSONObject!): UserDeckRecord!
  refresh(token: JWT!): SessionInfo

  """
  @invalidatesTokens(
      reason: "occupying existing room"
    )
    @triggersSubscriptions(
      signatures: ["activeRoomUpdates"]
    )
  """
  roomAddOccupant(id: ID!, occupantId: ID!): Room!
  roomCleanUpDead: Int!

  """
  @invalidatesTokens(
      reason: "occupying newly created room"
    )
    @triggersSubscriptions(
      signatures: ["activeRoomUpdates"]
    )
  """
  roomCreate: Room!

  """
  @triggersSubscriptions(
      signatures: ["activeRoomUpdates"]
    )
  """
  roomEditOwnerConfig(id: ID!, ownerConfig: JSONObject!): Room!

  """
  @triggersSubscriptions(
      signatures: ["activeRoomUpdates"]
    )
  """
  roomSetDeck(deckId: ID!, id: ID!): Room!

  """
  @invalidatesTokens(
      reason: "room may no longer be active"
    )
    @triggersSubscriptions(
      signatures: ["activeRoomUpdates"]
    )
  """
  roomSetState(id: ID!, state: RoomState!): Room!

  """
  @invalidatesTokens(
      reason: "name may be changed"
    )
  """
  userEdit(isPublic: Boolean, name: String): User!
}

type Query {
  deck(id: ID!): Deck!

  """implicit limit of 60"""
  decks(cursor: ID, scope: DecksQueryScope, take: Int, titleFilter: String): [Deck!]!
  health: String!
  message(id: ID!): Message!
  messagesOfRoom(id: ID!): [Message!]!
  occupyingActiveRooms: [Room!]!
  ownDeckRecord(deckId: ID!): UserDeckRecord
  room(id: ID!): Room!
  roomBySlug(slug: String!): Room!
  user(id: ID): User!
}

type Room {
  createdAt: DateTime!
  deck: Deck
  deckId: ID
  id: ID!
  internalConfig: JSONObject!
  messageCount: Int!
  messages: [Message!]!
  occupants: [User!]!
  occupantsCount: Int!
  owner: User!
  ownerConfig: JSONObject!
  ownerId: ID!
  slug: String
  state: RoomState!

  """
  guaranteed to be set only as part of the top-level RoomUpdate payload yielded by a subscription to roomUpdatesBySlug triggered by a successful roomAddOccupant
  """
  userIdOfLastAddedOccupantForSubscription: ID

  """
  guaranteed to be set only as part of the top-level RoomUpdate payload yielded by a subscription to roomUpdatesBySlug triggered by a successful roomAddOccupant
  """
  userOfLastAddedOccupantForSubscription: User
}

enum RoomState {
  SERVED
  SERVING
  WAITING
}

type RoomUpdate {
  operation: RoomUpdateOperation!
  value: Room!
}

enum RoomUpdateOperation {
  roomAddOccupant
  roomSetDeck
  roomSetState
}

type SessionInfo {
  currentUser: JSONObject!
  token: JWT!
}

type Subscription {
  messageUpdatesByRoomSlug(slug: String!): MessageUpdate!
  repeatHealth: String!
  roomUpdatesByRoomSlug(slug: String!): RoomUpdate!
}

"""
A field whose value is a generic Universally Unique Identifier: https://en.wikipedia.org/wiki/Universally_unique_identifier.
"""
scalar UUID

type User {
  decks: [Deck!]!
  facebookId: String
  googleId: String
  id: ID!
  isPublic: Boolean!
  name: String
  occupyingActiveRooms: [Room!]!
  ownedRooms: [Room!]!
  roles: [String!]!
}

type UserCardRecord {
  correctRecord: [DateTime!]!
}

type UserDeckRecord {
  notes: JSONObject!
}